{
  "suite": "fr_p2c_004_acl_journey",
  "cases": [
    {
      "name": "auth_without_config_is_rejected",
      "now_ms": 0,
      "argv": ["AUTH", "secret"],
      "expect": {
        "kind": "error",
        "value": "ERR AUTH <password> called without any password configured for the default user. Are you sure your configuration is correct?"
      }
    },
    {
      "name": "hello_auth_without_config_is_rejected",
      "now_ms": 1,
      "argv": ["HELLO", "3", "AUTH", "default", "secret"],
      "expect": {
        "kind": "error",
        "value": "ERR AUTH <password> called without any password configured for the default user. Are you sure your configuration is correct?"
      }
    },
    {
      "name": "hello_with_invalid_proto_is_rejected",
      "now_ms": 2,
      "argv": ["HELLO", "7"],
      "expect": {
        "kind": "error",
        "value": "NOPROTO unsupported protocol version '7'"
      }
    },
    {
      "name": "hello_auth_syntax_error_is_deterministic",
      "now_ms": 3,
      "argv": ["HELLO", "3", "AUTH", "default"],
      "expect": { "kind": "error", "value": "ERR syntax error" }
    },
    {
      "name": "auth_wrong_arity_is_rejected",
      "now_ms": 4,
      "argv": ["AUTH"],
      "expect": {
        "kind": "error",
        "value": "ERR wrong number of arguments for 'AUTH' command"
      }
    },
    {
      "name": "hello_wrong_arity_is_rejected",
      "now_ms": 5,
      "argv": ["HELLO"],
      "expect": {
        "kind": "error",
        "value": "ERR wrong number of arguments for 'HELLO' command"
      }
    },
    {
      "name": "auth_user_without_config_is_rejected",
      "now_ms": 6,
      "argv": ["AUTH", "alice", "secret2"],
      "expect": {
        "kind": "error",
        "value": "ERR AUTH <password> called without any password configured for the default user. Are you sure your configuration is correct?"
      }
    },
    {
      "name": "hello_unknown_option_is_syntax_error",
      "now_ms": 7,
      "argv": ["HELLO", "3", "SETNAME", "client-a"],
      "expect": { "kind": "error", "value": "ERR syntax error" }
    },
    {
      "name": "set_acl_contract_key",
      "now_ms": 8,
      "argv": ["SET", "fr:p2c:004:key", "value"],
      "expect": { "kind": "simple", "value": "OK" }
    },
    {
      "name": "get_acl_contract_key",
      "now_ms": 9,
      "argv": ["GET", "fr:p2c:004:key"],
      "expect": { "kind": "bulk", "value": "value" }
    },
    {
      "name": "config_set_requirepass_bridges_default_acl_user",
      "now_ms": 10,
      "argv": ["CONFIG", "SET", "requirepass", "secret"],
      "expect": { "kind": "simple", "value": "OK" }
    },
    {
      "name": "config_get_requirepass_after_bridge",
      "now_ms": 11,
      "argv": ["CONFIG", "GET", "requirepass"],
      "expect": {
        "kind": "array",
        "value": [
          { "kind": "bulk", "value": "requirepass" },
          { "kind": "bulk", "value": "secret" }
        ]
      }
    },
    {
      "name": "config_set_acllog_max_len",
      "now_ms": 12,
      "argv": ["CONFIG", "SET", "acllog-max-len", "256"],
      "expect": { "kind": "simple", "value": "OK" }
    },
    {
      "name": "config_get_acllog_max_len_with_pattern",
      "now_ms": 13,
      "argv": ["CONFIG", "GET", "acl*"],
      "expect": {
        "kind": "array",
        "value": [
          { "kind": "bulk", "value": "acllog-max-len" },
          { "kind": "bulk", "value": "256" }
        ]
      }
    },
    {
      "name": "config_clear_requirepass_restores_nopass_bridge",
      "now_ms": 14,
      "argv": ["CONFIG", "SET", "requirepass", ""],
      "expect": { "kind": "simple", "value": "OK" }
    },
    {
      "name": "config_get_requirepass_after_clear",
      "now_ms": 15,
      "argv": ["CONFIG", "GET", "requirepass"],
      "expect": {
        "kind": "array",
        "value": [
          { "kind": "bulk", "value": "requirepass" },
          { "kind": "bulk", "value": "" }
        ]
      }
    }
  ]
}
